<div *ngIf="showSolanaSelector" class="wallet-selector">
  <h3>Seleccionar Wallet Solana</h3>
  <p>Elige cÃ³mo quieres conectarte:</p>
  <div class="wallet-options">
    <button *ngFor="let wallet of solanaWallets" (click)="selectSolanaWallet(wallet.name)">
      {{ wallet.icon }} {{ wallet.name }}
    </button>
  </div>
  <button (click)="cancelWalletSelection()">Cancelar</button>
</div>

<div class="blockchain-selector">
  <h3>Seleccionar Blockchain</h3>
  <button (click)="selectBlockchain('ethereum')">Ethereum</button>
  <button (click)="selectBlockchain('solana')">Conectar Wallet Solana</button>
  <p>Modo: {{ currentBlockchain() === 'ethereum' ? 'Ethereum' : 'Solana' }}</p>
</div>

<div class="status">
  <p>Estado: {{ currentBlockchain() === 'ethereum' ? providerStatus : solanaProviderStatus }}</p>
  <button (click)="debugService()">Debug</button>
</div>

<div class="auth-section">
  <div *ngIf="isAuthenticated">
    <p>Autenticado como: {{ firebaseUser?.email || 'Usuario anÃ³nimo' }} <span *ngIf="isAdmin">ðŸ‘‘ Admin</span></p>
    <p>UID: {{ firebaseUser?.uid }}</p>
    <button (click)="logout()">ðŸšª Cerrar sesiÃ³n</button>
    <div *ngIf="isAdmin">
      <p>Funciones de administrador:</p>
      <button (click)="resetAdminTo()">ðŸ”§ Resetear DirecciÃ³n Admin</button>
    </div>
  </div>
  <div *ngIf="!isAuthenticated">
    <p>No autenticado - Elige cÃ³mo quieres continuar:</p>
    <button (click)="authWallet.signInWithGoogle()">ðŸš€ Iniciar con Google</button>
    <button (click)="loginAnonymous()">ðŸ”’ Pagar anÃ³nimamente</button>
    <p>* Google te permite guardar tu historial de transacciones</p>
  </div>
</div>

<div class="transactions-ethereum">
  <h3>Transacciones Ethereum</h3>
  <table *ngIf="ethTransactions().length > 0">
    <tr>
      <th>Click para ver estado actual de la transaccion</th>
      <th>De</th>
      <th>A</th>
      <th>Monto</th>
      <th>Moneda</th>
      <th>Fecha</th>
      <th>Estado</th>
    </tr>
    <tr *ngFor="let tx of ethTransactions()">
      <td><a [href]="getExplorerUrl(tx)" target="_blank">{{ tx.txHash | slice:0:10 }}...</a></td>
      <td>{{ tx.from | slice:0:10 }}...</td>
      <td>{{ tx.to | slice:0:10 }}...</td>
      <td>{{ tx.amount }}</td>
      <td>{{ tx.currency }}</td>
      <td>{{ formatTimestamp(tx.timestamp) | date:'short' }}</td>
      <td>{{ tx.status }}</td>
    </tr>
  </table>
  <p *ngIf="ethTransactions().length === 0">No hay transacciones Ethereum.</p>
</div>

<div class="transactions-solana">
  <h3>Transacciones Solana</h3>
  <table *ngIf="solanaTransactions().length > 0">
    <tr>
      <th>Tx Hash</th>
      <th>De</th>
      <th>A</th>
      <th>Monto</th>
      <th>Moneda</th>
      <th>Fecha</th>
      <th>Estado</th>
    </tr>
    <tr *ngFor="let tx of solanaTransactions()">
      <td><a [href]="getExplorerUrl(tx)" target="_blank">{{ tx.txHash | slice:0:10 }}...</a></td>
      <td>{{ tx.from | slice:0:10 }}...</td>
      <td>{{ tx.to | slice:0:10 }}...</td>
      <td>{{ tx.amount }}</td>
      <td>{{ tx.currency }}</td>
      <td>{{ formatTimestamp(tx.timestamp) | date:'short' }}</td>
      <td>{{ tx.status }}</td>
    </tr>
  </table>
  <p *ngIf="solanaTransactions().length === 0">No hay transacciones Solana.</p>
</div>

<div class="wallet-ethereum" *ngIf="account && currentBlockchain() === 'ethereum'">
  <h3>Ethereum Wallet</h3>
  <p>Cuenta: {{ account }}</p>
  <p>Red: {{ chainSymbol }} (ID: {{ chainId }})</p>
  <p>Saldo: {{ balance }} {{ chainSymbol }}</p>
  <div>
    <h4>Cambiar Red</h4>
    <select (change)="switchChain($any($event.target).value)">
      <option *ngFor="let chain of availableChains" [value]="chain.id">{{ chain.name }}</option>
    </select>
  </div>
  <div>
    <h4>Enviar</h4>
    <div *ngIf="!isHardcoded()">
      <p>No hay direcciÃ³n administrativa configurada.</p>
    </div>
    <input type="text" [ngModel]="adminTo() ?? ''" [disabled]="isHardcoded()" placeholder="DirecciÃ³n de destino">
    <input type="text" [(ngModel)]="amount" placeholder="Monto (ej: 0.0008)" step="0.0001"> <!-- âœ… Cambiado a type="text" -->
    <button [disabled]="!isAuthenticated || !isHardcoded()" (click)="sendTransaction(to, amount)">
      {{ !isAuthenticated ? 'ðŸ”’ AutentÃ­cate primero' : !isHardcoded() ? 'ðŸ”§ Configura direcciÃ³n admin' : 'ðŸš€ Enviar' }}
    </button>
  </div>
</div>

<div class="wallet-solana" *ngIf="currentBlockchain() === 'solana'">
  <div *ngIf="solanaConnected">
    <h3>Solana Wallet Conectada</h3>
    <p>Wallet: {{ solanaWalletName }}</p>
    <p>Cuenta: {{ solanaAccount }}</p>
    <p>Saldo: {{ solanaBalance }} SOL</p>
    <div>
      <h4>Enviar SOL</h4>
      <div *ngIf="!isHardcoded()">
        <p>No hay direcciÃ³n administrativa configurada.</p>
      </div>
      <input type="text" [ngModel]="adminTo() ?? ''" [disabled]="isHardcoded()" placeholder="DirecciÃ³n de destino">
      <input type="text" [(ngModel)]="amount" placeholder="Monto (ej: 0.0008)" step="0.0001"> <!-- âœ… Cambiado a type="text" -->
      <button [disabled]="!solanaConnected || !isHardcoded()" (click)="sendTransaction(to, amount)">
        {{ !solanaConnected ? 'ðŸ”’ Conecta wallet primero' : !isHardcoded() ? 'ðŸ”§ Configura direcciÃ³n admin' : 'ðŸš€ Enviar SOL' }}
      </button>
    </div>
  </div>
  <div *ngIf="!solanaConnected">
    <p>Selecciona "Conectar Wallet Solana" arriba para comenzar</p>
    <p>Wallets detectadas: {{ solanaWallets.length }}</p>
    <p *ngIf="solanaWallets.length === 0">No se detectaron wallets Solana. Instala Phantom o Solflare.</p>
  </div>
</div>

<div class="no-wallet" *ngIf="!account && currentBlockchain() === 'ethereum'">
  <p>No hay wallet Ethereum conectada.</p>
  <button (click)="connectWallet()">ðŸ”— Conectar MetaMask</button>
</div>